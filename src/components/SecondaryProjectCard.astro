---
import type {HTMLAttributes} from 'astro/types';
import ProjectTag from './ProjectTag.astro';
import ProjectImage from './ProjectImage.astro';
import {CATEGORY_TO_VARIANT, CATEGORY_LABELS, type ProjectData} from '../utils/project-categories';
import {interactiveCardClasses} from '../utils/card-styles';
import {cn} from '../utils/cn';

/**
 * Secondary Project Card component for displaying non-featured projects
 * Horizontal layout with square thumbnail, title, single-line description, and one tag
 *
 * Uses utilities:
 * - CATEGORY_TO_VARIANT for mapping categories to tag variants
 * - CATEGORY_LABELS for display labels
 * - ProjectImage for consistent image rendering
 * - Global line-clamp-1 utility for text truncation
 *
 * @example
 * ```astro
 * <SecondaryProjectCard
 *   project={{
 *     title: 'Data Analysis Tool',
 *     description: 'A comprehensive data analysis toolkit for researchers',
 *     image: '/images/project.png',
 *     category: 'research',
 *     skills: ['Python', 'Pandas'],
 *     tools: ['Jupyter']
 *   }}
 *   slug="data-analysis-tool"
 * />
 * ```
 */
export interface Props extends HTMLAttributes<'article'> {
  /** Project data from content collection */
  project: ProjectData;
  /** Project slug for linking to detail page */
  slug: string;
}

const {project, slug, class: className, ...attrs} = Astro.props;
---

<article
  data-component="secondary-project-card"
  class={interactiveCardClasses(cn('group relative flex items-stretch min-h-11', className))}
  {...attrs}
>
  <a
    href={`/projects/${slug}`}
    class="flex items-stretch w-full focus:outline-none"
    aria-labelledby={`secondary-project-title-${slug}`}
  >
    <!-- Square thumbnail on left -->
    <ProjectImage
      image={project.image}
      alt={`Thumbnail of ${project.title} project`}
      variant="thumbnail"
    />

    <!-- Content on right -->
    <div class="flex flex-col justify-center p-3 md:p-4 flex-1 min-w-0">
      <!-- Title -->
      <h3
        id={`secondary-project-title-${slug}`}
        class="font-display text-base md:text-lg font-semibold text-text dark:text-text-dark line-clamp-1"
      >
        {project.title}
      </h3>

      <!-- Single-line description with truncation -->
      <p
        class="mt-1 text-sm text-text-secondary dark:text-text-secondary-dark line-clamp-1"
      >
        {project.description}
      </p>

      <!-- Single tag only -->
      <div class="mt-2">
        <ProjectTag variant={CATEGORY_TO_VARIANT[project.category]}>
          {CATEGORY_LABELS[project.category]}
        </ProjectTag>
      </div>
    </div>
  </a>
</article>
