---
import type {HTMLAttributes} from 'astro/types';
import SectionHeading from './SectionHeading.astro';

/**
 * ContactSection displays contact options and CV download link.
 * Positioned as a prominent call-to-action section on the About page.
 *
 * Button layout:
 * - LinkedIn (primary CTA, accent background) - recruiter journey
 * - GitHub (secondary, bordered) - developer/portfolio journey
 * - CV (secondary, bordered, optional) - download resume
 *
 * All external links open in new tabs with proper security attributes
 * (target="_blank", rel="noopener noreferrer").
 *
 * @example
 * ```astro
 * <ContactSection />
 * ```
 *
 * @example
 * ```astro
 * <ContactSection showCV={false} />
 * ```
 */
interface Props extends HTMLAttributes<'section'> {
  /** Whether to show the CV download link (default: true) */
  showCV?: boolean;
}

const {showCV = true, class: className, ...attrs} = Astro.props;

// Contact information
const linkedInUrl = 'https://www.linkedin.com/in/crisbenge/';
const githubUrl = 'https://github.com/cbenge509';
const cvUrl = '/cris-benge-cv.pdf';

// Check if CV file exists at build time by checking if it should be rendered
// The showCV prop can be used to conditionally hide the CV link
const shouldShowCV = showCV;
---

<section
  class:list={[
    'py-16 md:py-20 px-6 md:px-8 bg-surface dark:bg-surface-dark rounded-2xl',
    className,
  ]}
  aria-labelledby="contact-heading"
  data-testid="contact-section"
  {...attrs}
>
  <div class="max-w-3xl mx-auto text-center">
    <SectionHeading id="contact-heading">
      Get In Touch
      <span slot="subtitle">
        Interested in connecting? Reach out on LinkedIn or check out my work on GitHub.
      </span>
    </SectionHeading>

    <div class="flex flex-wrap justify-center gap-4">
      <!-- Primary CTA: LinkedIn (recruiter journey) -->
      <a
        href={linkedInUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-2 px-6 py-3 min-h-11 bg-accent dark:bg-accent-dark text-white rounded-lg font-medium hover:bg-accent-hover dark:hover:bg-accent-hover-dark transition-colors duration-150 focus-ring"
        aria-label="Connect on LinkedIn (opens in new tab)"
        data-testid="linkedin-link"
      >
        Connect on LinkedIn
        <span aria-hidden="true">↗</span>
      </a>

      <!-- Secondary: GitHub -->
      <a
        href={githubUrl}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-2 px-6 py-3 min-h-11 border border-border dark:border-border-dark text-text dark:text-text-dark rounded-lg hover:bg-surface-dark/5 dark:hover:bg-surface/5 transition-colors duration-150 focus-ring"
        aria-label="GitHub profile (opens in new tab)"
        data-testid="github-button"
      >
        View GitHub
        <span aria-hidden="true">↗</span>
      </a>

      <!-- CV Download -->
      {
        shouldShowCV && (
          <a
            href={cvUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-2 px-6 py-3 min-h-11 border border-border dark:border-border-dark text-text dark:text-text-dark rounded-lg hover:bg-surface-dark/5 dark:hover:bg-surface/5 transition-colors duration-150 focus-ring"
            aria-label="View CV (opens in new tab)"
            data-testid="cv-link"
          >
            View CV
            <span aria-hidden="true">↗</span>
          </a>
        )
      }
    </div>
  </div>
</section>
